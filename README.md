Crop Yield Prediction using Ensemble Learning
This repository contains the code and resources for a machine learning project focused on predicting crop yield. The model leverages a stacked ensemble of XGBoost and CatBoost to achieve high accuracy.
üìù Overview
Accurate prediction of crop yield is crucial for agricultural planning, food security, and economic stability. This project aims to develop a robust predictive model using various agricultural and environmental factors from a comprehensive dataset. The final model achieves an impressive R¬≤ score of 0.94, indicating a high degree of accuracy.
üìä Dataset
The model is trained on the crop_yield.csv dataset, which includes the following features:
Crop: Type of crop grown.
Crop_Year: The year of harvest.
Season: The season during which the crop was grown.
State: The state in India where the crop was cultivated.
Area: The area of land used for cultivation.
Production: The total production of the crop.
Annual_Rainfall: The annual rainfall in the region.
Fertilizer: The amount of fertilizer used.
Pesticide: The amount of pesticide used.
Yield: The final crop yield (target variable).
ü§ñ Methodology
The project follows a standard machine learning workflow:
Data Preprocessing: Categorical features (Crop, Season, State) were converted to numerical values using LabelEncoder.
Feature Engineering: A correlation analysis was performed, which revealed high multicollinearity between Fertilizer and Pesticide usage. These features were subsequently removed to improve model performance.
Feature Scaling: All numerical features were standardized using StandardScaler to ensure that each feature contributes equally to the model's predictions.
Modeling: A stacked ensemble model was built using two powerful base estimators:
XGBoost (XGBRegressor)
CatBoost (CatBoostRegressor)
A Ridge Regression model was used as the final meta-estimator to combine the predictions from the base models.
Evaluation: The model was trained on 80% of the data and evaluated on the remaining 20%. The performance was measured using the R¬≤ score and Root Mean Squared Error (RMSE).
‚ú® Results
The stacked ensemble model achieved the following results on the test set:
R¬≤ Score: 0.9402
Root Mean Squared Error (RMSE): 218.95
The high R¬≤ score indicates that the model can explain 94% of the variance in crop yield, making it a highly reliable predictive tool.
üöÄ How to Use
To get started with this project, follow these steps:
Clone the repository:
git clone https://github.com/your-username/crop-yield-prediction.git
cd crop-yield-prediction


Install the required libraries:
pip install pandas matplotlib seaborn scikit-learn xgboost catboost joblib


Run the Jupyter Notebook:
Open and run the cropYieldPrediction1.ipynb notebook to see the complete workflow, from data loading to model training and evaluation.
üì¶ Saved Files
The following files are generated by the notebook and are essential for making predictions with the trained model:
xgb_crop_model.pkl: The trained stacked ensemble model.
label_encoders.pkl: A dictionary containing the fitted LabelEncoder for each categorical feature.
Individual encoder files (e.g., Crop_encoder.pkl, Season_encoder.pkl, State_encoder.pkl) are also saved for convenience.
